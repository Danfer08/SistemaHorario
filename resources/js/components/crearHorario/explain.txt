# Prompt para IA - Sistema de Gestión de Horarios Académicos

## Contexto del Sistema
Desarrollar un sistema de gestión de horarios académicos con arquitectura de tres tablas principales y funcionalidades de arrastrar y soltar.

## Estructura de Base de Datos

### Tabla 1: `horario`
```sql
idHorario (PK)
año (ej: 2025)
etapa (ej: I, II)
fecha (timestamp)
estado (borrador, publicado)
```

### Tabla 2: `horario_curso`
```sql
idHorarioCurso (PK)
FK_idProfesor
FK_idCurso
tipo (regular, irregular)
FK_idHorario
Grupo (1, 2, 3...)
Nr_estudiantes
```

### Tabla 3: `detalle_horario_curso`
```sql
idDetalle_Horario_Curso (PK)
FK_idHorarioCurso
FK_idSalon
dia (Lunes, Martes, ...)
Hora_inicio (HH:MM)
Hora_fin (HH:MM)
```

## Relaciones
- **horario** (1) → (N) **horario_curso** - Un horario contiene múltiples asignaciones de cursos
- **horario_curso** (1) → (N) **detalle_horario_curso** - Un curso asignado tiene múltiples sesiones horarias

## Requisitos Funcionales

### 1. Gestión de Cursos por Grupos
- Un curso puede tener múltiples grupos (Grupo 1, 2, 3...)
- Cada grupo es el mismo curso con misma cantidad de horas
- Visualización agrupada con capacidad de expandir/colapsar

### 2. Interfaz Drag & Drop
- Arrastrar cursos disponibles a celdas del horario
- Modal para configurar: profesor, salón, grupo, número de estudiantes
- Validación de conflictos en tiempo real

### 3. Flujo de Asignación
```javascript
// Paso 1: Crear horario_curso (asignación principal)
POST /api/horarios/{id}/asignar-curso
{
  curso_id,
  profesor_id,
  grupo,
  estudiantes,
  tipo: "regular" | "irregular"
}

// Paso 2: Crear detalle_horario_curso (sesión específica)
POST /api/horarios/{id}/agregar-detalle
{
  idHorarioCurso,
  salon_id,
  dia,
  hora_inicio,
  hora_fin
}
```

### 4. Gestión Visual
- **Agrupamiento**: Cursos con múltiples sesiones deben mostrarse agrupados
- **Expandir/Colapsar**: Ver todas las sesiones de un grupo
- **Identificación visual**: Diferentes colores para regular/irregular

### 5. Operaciones CRUD
- **Crear**: Asignar curso + detalles horarios
- **Leer**: Cargar horario con agrupamiento visual
- **Actualizar**: Modificar sesiones específicas
- **Eliminar**: Solo eliminar `detalle_horario_curso` (sesión individual)

## Especificaciones Técnicas

### Frontend Requirements
- **React** con hooks personalizados
- **Drag & Drop** nativo o librería ligera
- **Interfaz responsive** con grid de horario
- **Agrupamiento visual** de sesiones múltiples

### Backend Requirements
- **REST API** con validación de conflictos
- **Endpoints** para gestión de las 3 tablas
- **Validaciones**: 
  - Conflictos de horario (profesor, salón)
  - Capacidad de salón vs estudiantes
  - Solapamiento de horarios

### Flujos de Usuario
1. **Seleccionar período** (año, etapa, ciclo)
2. **Ver cursos disponibles** filtrados por ciclo
3. **Arrastrar curso** a celda horaria
4. **Configurar asignación** en modal
5. **Ver agrupamiento** visual de sesiones
6. **Expandir/colapsar** para ver detalles
7. **Eliminar sesiones** individualmente

## Validaciones de Negocio
- Un profesor no puede tener dos clases simultáneas
- Un salón no puede estar ocupado dos veces a la misma hora
- Número de estudiantes no puede exceder capacidad del salón
- Cursos del mismo grupo deben tener mismo profesor y características

## Respuesta Esperada
Generar código completo para:
1. Hook React para gestión de estado
2. Componentes de UI para grid y agrupamiento
3. Endpoints API para las operaciones CRUD
4. Lógica de agrupamiento visual y expandible
5. Validaciones de conflicto en backend

¿Puedes desarrollar esta solución manteniendo la arquitectura de tres tablas y cumpliendo todos los requisitos funcionales descritos?